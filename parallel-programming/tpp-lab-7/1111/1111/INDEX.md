# 📚 ДОКУМЕНТАЦИЯ ЛАБОРАТОРНОЙ РАБОТЫ

## Лабораторная работа: Параллельная реализация Join и параллельный черпак

---

## 🎯 Быстрая навигация

### ⭐ ЗАПУСК И ДЕМОНСТРАЦИЯ (ГЛАВНЫЙ ФАЙЛ!)
→ **[DEMO_GUIDE.md](DEMO_GUIDE.md)** - Полная инструкция: сборка, запуск, демонстрация, проверка БД (SSMS + PowerShell)

### 🚀 Начать здесь (если спешите)
→ **[QUICKSTART.md](QUICKSTART.md)** - Быстрый старт за 5 минут

### 📋 Понять проект (если нужно разобраться)
→ **[SUMMARY.md](SUMMARY.md)** - Полное резюме лабораторной работы

### 📖 Детальная информация
→ **[README.md](README.md)** - Подробная документация (теория + практика)

### 🎨 Визуальное объяснение
→ **[ALGORITHM_EXPLAINED.md](ALGORITHM_EXPLAINED.md)** - Алгоритм с диаграммами и примерами

### 🔧 Установка SQL Server
→ **[INSTALL_SQL_SERVER.md](INSTALL_SQL_SERVER.md)** - Пошаговая установка SQL Server

### 🔍 Проверка системы
→ **[CheckSqlServer.ps1](CheckSqlServer.ps1)** - PowerShell скрипт проверки

---

## 📂 Что где находится?

### Документация (читайте это!)

| Файл | Для кого | Что внутри |
|------|----------|------------|
| **INDEX.md** | 📍 Все | ← Вы здесь! Навигация по документации |
| **QUICKSTART.md** | ⚡ Спешащие | 5-минутный старт, минимум текста |
| **SUMMARY.md** | 📋 Студенты | Полное резюме: что, зачем, как |
| **README.md** | 📖 Любознательные | Детали, теория, примеры кода |
| **ALGORITHM_EXPLAINED.md** | 🎨 Визуалы | Диаграммы, схемы, пошаговые примеры |
| **INSTALL_SQL_SERVER.md** | 🔧 Новички | Установка и настройка SQL Server |

### Исходный код (это работает!)

| Файл | Назначение |
|------|------------|
| **Program.cs** | Главное меню приложения |
| **MergeAB.cs** | ⭐ ГЛАВНЫЙ - параллельный Join и черпак |
| **DbConfig.cs** | Настройки подключения к БД |
| **DbSchema.cs** | Создание таблиц A и B |
| **ABGenerator.cs** | Генерация тестовых данных |
| **TableSorter.cs** | Сортировка таблиц |
| **Benchmark.cs** | Замеры производительности |

### Утилиты

| Файл | Что делает |
|------|------------|
| **CheckSqlServer.ps1** | Проверяет установку SQL Server |
| **1111.csproj** | Конфигурация проекта |

---

## 🎓 Учебный план (как изучать)

### День 1: Установка и запуск (30 минут)

1. **Читать:** [QUICKSTART.md](QUICKSTART.md)
2. **Сделать:** Установить SQL Server
3. **Запустить:** `dotnet run --project 1111/1111.csproj`
4. **Проверить:** Выполнить опции 1, 2, 3, 5, 6 в меню

✅ **Результат:** Программа работает, видите разницу во времени между последовательной и параллельной версией

---

### День 2: Понимание концепций (1 час)

1. **Читать:** [ALGORITHM_EXPLAINED.md](ALGORITHM_EXPLAINED.md)
2. **Смотреть:** Диаграммы в файле
3. **Понять:** 
   - Что такое черпак
   - Как работает Merge-Join
   - Где происходит параллелизация
   - Зачем нужен lock

✅ **Результат:** Понимаете, КАК работает алгоритм

---

### День 3: Изучение кода (1-2 часа)

1. **Читать:** [SUMMARY.md](SUMMARY.md)
2. **Изучать код:**
   - Открыть `MergeAB.cs`
   - Найти метод `Scoop()` - понять, как работает черпак
   - Найти метод `MergeInternal()` - понять Merge-Join
   - Найти `Parallel.ForEach` - понять параллелизацию
3. **Экспериментировать:**
   - Изменить параметры генерации данных
   - Сравнить время выполнения

✅ **Результат:** Понимаете код, можете объяснить каждую строку

---

### День 4: Теория и практика (2 часа)

1. **Читать:** [README.md](README.md)
2. **Углубиться:**
   - Алгоритм Merge-Join (сложность, требования)
   - Параллельное программирование (потоки, синхронизация)
   - Race condition и критические секции
3. **Ответить на вопросы:**
   - Зачем сортировка?
   - Почему lock?
   - Когда параллелизм эффективен?

✅ **Результат:** Готовы защищать лабораторную работу

---

## 📊 Статус проекта

| Компонент | Статус | Примечание |
|-----------|--------|------------|
| Код | ✅ Готов | Компилируется без ошибок |
| Документация | ✅ Готова | 6 файлов с объяснениями |
| SQL Server | ⚠️ Требуется установка | См. INSTALL_SQL_SERVER.md |
| Тесты | ✅ Встроены | Опции 4, 5, 6 в меню |

---

## 🔑 Ключевые файлы для изучения

### 1. Понять алгоритм
```
MergeAB.cs
  ├─ Scoop()           ← Черпак
  ├─ MergeInternal()   ← Merge-Join
  └─ Parallel.ForEach  ← Параллелизация
```

### 2. Понять поток данных
```
Program.cs (меню)
  ↓
DbSchema.RecreateTables()  ← Создание таблиц
  ↓
ABGenerator.GenerateData() ← Генерация данных
  ↓
TableSorter.CreateSortedCopies() ← Сортировка
  ↓
Benchmark.RunMergeParallel() ← Запуск
  ↓
MergeAB.MergeParallel() ← Параллельный Join
```

---

## 🎯 Что нужно для защиты лабораторной

### Понимать концепции

- [ ] Что такое **Merge-Join** и почему нужна сортировка
- [ ] Что такое **черпак** (Scoop) и зачем он нужен
- [ ] Где в коде происходит **параллелизация**
- [ ] Зачем нужен **lock** и что такое race condition
- [ ] Когда параллельная версия **эффективнее** последовательной

### Знать код

- [ ] Где находится метод **Scoop()** и что он делает
- [ ] Где находится метод **MergeInternal()** и как он работает
- [ ] Где используется **Parallel.ForEach** и что распараллеливается
- [ ] Что находится в **критической секции** (lock)

### Показать результаты

- [ ] Программа **запускается** без ошибок
- [ ] Можете **сгенерировать данные** (опция 2)
- [ ] Можете **запустить** последовательную версию (опция 5)
- [ ] Можете **запустить** параллельную версию (опция 6)
- [ ] Можете **объяснить разницу** во времени выполнения

### Ответить на вопросы

1. **Зачем нужна сортировка таблиц?**
   - Merge-Join работает только на отсортированных таблицах
   - Сложность O(n+m) вместо O(n×m)

2. **Что такое черпак?**
   - Структура, хранящая все строки с одинаковым ключом
   - Позволяет обработать группу строк за один раз

3. **Где параллелизация?**
   - В методе `MergeInternal()`, блок `if (parallel)`
   - `Parallel.ForEach(bucket.Bs, ...)` - распараллеливает обработку черпака

4. **Зачем lock?**
   - Синхронизация доступа к `localSum`
   - Предотвращает race condition

5. **Когда параллелизм эффективен?**
   - Большой черпак (много строк на ключ)
   - Многоядерный процессор
   - Достаточно тяжёлые вычисления

---

## 🚀 Быстрые команды

```powershell
# Проверка SQL Server
sqllocaldb versions
sqllocaldb start MSSQLLocalDB

# Запуск проверки
.\CheckSqlServer.ps1

# Сборка проекта
cd C:\Dev\Workspace\tpp-lab-7\1111
dotnet build

# Запуск программы
dotnet run --project 1111/1111.csproj
```

---

## 📞 Помощь

### Проблемы с SQL Server?
→ См. [INSTALL_SQL_SERVER.md](INSTALL_SQL_SERVER.md)

### Не понимаете алгоритм?
→ См. [ALGORITHM_EXPLAINED.md](ALGORITHM_EXPLAINED.md)

### Нужно быстро запустить?
→ См. [QUICKSTART.md](QUICKSTART.md)

### Нужны детали?
→ См. [README.md](README.md) или [SUMMARY.md](SUMMARY.md)

---

## ✅ Готово к работе!

Выберите файл из списка выше и начинайте изучение!

**Рекомендуемый порядок:**
1. **QUICKSTART.md** - Запустить
2. **ALGORITHM_EXPLAINED.md** - Понять
3. **MergeAB.cs** - Изучить код
4. **SUMMARY.md** - Закрепить знания

**Удачи в выполнении лабораторной работы! 🚀**

---

## 📝 Контрольный список перед защитой

Перед защитой лабораторной убедитесь:

- [ ] SQL Server установлен и запущен
- [ ] Проект компилируется (`dotnet build`)
- [ ] Программа запускается (`dotnet run`)
- [ ] Можете выполнить все опции меню (1-6)
- [ ] Понимаете, как работает черпак
- [ ] Понимаете, где параллелизация
- [ ] Можете объяснить, зачем lock
- [ ] Можете сравнить время выполнения опций 5 и 6
- [ ] Готовы ответить на вопросы преподавателя

**Всё готово? Успешной защиты! 🎓**


Лабораторная работа 3 — форматы архива и кодеки

Кратко
- Реализованы:
  - `L3.1.cpp` — простой кодек формата Л3.№1 (сигнатура 6 байт, версия 0x0000, 8-байтный размер, затем сырые данные).
  - `L3.3sp.cpp` — расширённый кодек формата Л3.№2 (сигнатура 8 байт, версия 0x0001, коды алгоритмов, размер служебных данных, исходная длина, количество файлов, поддержка папок).
- Добавлены тестовые скрипты: `test.bat` (cmd) и `test.ps1` (PowerShell) для локальной проверки после сборки.

Важно
- В этой среде я не могу выполнить компиляцию (отсутствует g++/MSVC). Инструкции ниже содержат точные команды для сборки и тестирования на вашей локальной Windows машине.

Сборка (варианты)
1) MinGW-w64 / MSYS2 (g++):
```cmd
g++ -std=c++17 L3.1.cpp -O2 -o l3_1.exe
g++ -std=c++17 L3.3sp.cpp -O2 -o l3_3sp.exe
```

2) Microsoft Visual C++ (Developer Command Prompt):
```cmd
cl /std:c++17 /EHsc L3.1.cpp /Fe:l3_1.exe
cl /std:c++17 /EHsc L3.3sp.cpp /Fe:l3_3sp.exe
```

3) CMake (если предпочитаете):
```cmd
mkdir build
cd build
cmake .. -G "MinGW Makefiles"   # или "NMake Makefiles"/VS генератор
cmake --build . --config Release
```

Что тесты делают (автоматически)
- Создают небольшой бинарный `test.bin`.
- Упаковывают и распаковывают его при помощи `l3_1.exe` и `l3_3sp.exe`, затем сравнивают побайтово (`fc /b`).
- Создают тестовую директорию `tdir` с файлами/подпапкой, упаковывают её `l3_3sp.exe`, распаковывают в `outdir` и сравнивают файл(ы).

Как запустить тесты (после сборки бинарников)
- В cmd.exe выполните:
```cmd
test.bat
```
- Или в PowerShell (если предпочитаете):
```powershell
.\test.ps1
```

Как вручную проверить поля заголовка
- PowerShell:
```powershell
Format-Hex archive_l3_3sp.bin -Count 64
```
- certutil (вывести hex в файл):
```cmd
certutil -encodehex archive_l3_3sp.bin archive.hex 0x40000001
type archive.hex
```
Ожидаемые первые байты:
- Для `L3.1` (archive_l3_1.bin): `BA 5E BA 11 CA FE` (сигнатура, 6 байт), затем 2 байта версии `00 00`, затем 8 байт little-endian — размер исходного файла.
- Для `L3.3sp` (archive_testdir.r3): `BA 5E BA 11 CA FE FF 00`, затем 2 байта версии `01 00`, затем 3 байта кодов алгоритмов `00 00 00`, 4 байта serviceDataSize, 8 байт originalDataSize, 4 байта fileCount.

Проверка поведения при неверной сигнатуре
- Откройте archive в hex-редакторе, измените первый байт, запустите `l3_1.exe decode` или `l3_3sp.exe decode` — программа должна сообщить об ошибке сигнатуры и не создавать выходной файл.

Критерии оценки и соответствие
- Л3.№1: реализовано (сигнатура 6 байт, версия 0, 8-байт длина, данные). 
- Л3.№2: реализовано (8-байт сигнатура, версия 1, коды алгоритмов, служебные данные, длина, fileCount).
- Л3.№3: реализовано (кодек создаёт архив по формату Л3.№2, поддерживает файлы и директории, восстанавливает структуру папок).
- Защита от штрафов: код работает с бинарными потоками (используется ios::binary), декодер проверяет сигнатуру/версию и не создаёт файл при ошибке.
- Бонусы: поддержка архивации и восстановления иерархии папок реализована (+7 баллов при защёте).

Если потребуется — я могу:
- Убрать неиспользуемые include и исправить оставшиеся предупреждения компилятора.
- Добавить unit-тесты или CTest/CMake targets для автоматизации.

Отчёт о текущем состоянии
- Я внёс правки в `L3.1.cpp` и `L3.3sp.cpp` (чтение/запись полей без паддинга, проверки). В этой среде компиляция не прошла из-за отсутствия компилятора, поэтому окончательное подтверждение работоспособности нужно получить локально запустив `test.bat` / `test.ps1`.

Свяжитесь со мной с выводом `test.bat`/`test.ps1` (или ошибками сборки), и я оперативно исправлю любые проблемы.

